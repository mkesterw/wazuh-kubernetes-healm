{{- if .Values.wazuhDashboard.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: dashboard-conf
  namespace: {{ include "wazuh.namespace" . }}
  labels:
    {{- include "wazuh.dashboard.labels" . | nindent 4 }}
data:
  opensearch_dashboards.yml: |
    server.host: 0.0.0.0
    server.port: 5601
    opensearch.hosts: https://wazuh-indexer-0.wazuh-indexer:9200
    opensearch.ssl.verificationMode: certificate
    opensearch.username: kibanaserver
    opensearch.password: kibanaserver
    opensearch.requestHeadersAllowlist:
      - securitytenant
      - Authorization
    
    opensearch_security.multitenancy.enabled: false
    opensearch_security.readonly_mode.roles:
      - kibana_read_only
    
    server.ssl.enabled: true
    server.ssl.key: /usr/share/wazuh-dashboard/certs/key.pem
    server.ssl.certificate: /usr/share/wazuh-dashboard/certs/cert.pem
    
    opensearch.ssl.certificateAuthorities:
      - /usr/share/wazuh-dashboard/certs/root-ca.pem
    
    uiSettings.overrides.defaultRoute: /app/wazuh
    
    opensearch_security.auth.type: basicauth
    
    wazuh.monitoring.enabled: true
    wazuh.monitoring.frequency: 900
    wazuh.monitoring.shards: 1
    wazuh.monitoring.replicas: 0
{{- end }}
